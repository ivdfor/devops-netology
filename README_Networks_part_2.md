Домашнее задание по лекции "Компьютерные сети (лекция 2)"

1) Проверьте список доступных сетевых интерфейсов на вашем компьютере. Какие команды есть для этого в Linux и в Windows?

Ответ:

В Windows-

команда:

ipconfig -all

она же:

ipconfig /all

в Linux-

команды-

ip address

ip link

ifconfig (ранее использовалась, а теперь доступна после установки пакета net-tools)


2) Какой протокол используется для распознавания соседа по сетевому интерфейсу? Какой пакет и команды есть в Linux для этого?

Ответ:

Протокол LLDP (Link Layer Discovery Protocol)

необходимо установить пакет lldpd( так же возможно использоване lldpad(менее популярен))

apt-get install lldpd

или

yum install lldpd

запустить и добавить в загрузку процесс

systemctl start lldpd.service

systemctl enable lldpd.service

просмотр информации о соседях:

lldpcli show neighbors

просмотр статистики:

lldpcli show statistics

просмотр конфигурации:

lldpcli show running-configuration

Кроме того, возможно специфичное изменение поведения и вывода команды в зависимости 
от применяемых ключей (дебаг, кастомная фильтрация (подробная информация man lldpd)).


3) Какая технология используется для разделения L2 коммутатора на несколько виртуальных сетей? Какой пакет и команды есть в Linux для этого? Приведите пример конфига.

Ответ:

Для разделения используем VLAN (Virtual Local Area Network)

Для семейства Debian

Имплементируем поддержку тегирования 802.1q ядром Linux

modprobe 8021q

Создаем логический интерфейс, привязанный к физическому, например к Eth 0 создадим int Eth0.333 (VLAN 333)

ip link add link eth0 name eth0.333 type vlan id 333

либо

vconfig add eth0 333 (использование vconfig в состоянии deprecated, ожидается прекращение поддержки)

Назначаем ip на созданный сабинтерфейс

ip address add 192.168.0.1/24 dev eth0.333

Включаем сабинтерфейс

ip link set eth0.333 up

Проверяем:

vagrant@vagrant:~$ ip a | grep eth0.333

3: eth0.333@eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP group default qlen 1000 inet 192.168.0.1/24 scope global eth0.333


4) Какие типы агрегации интерфейсов есть в Linux? Какие опции есть для балансировки нагрузки? Приведите пример конфига.

Ответ:

Типы агрегации и балансировки:

mode=0 (balance-rr)
При этом методе объединения трафик распределяется по принципу «карусели»: пакеты по очереди направляются на сетевые карты объединённого интерфейса. Например, если у нас есть физические интерфейсы eth0, eth1, and eth2, объединенные в bond0, первый пакет будет отправляться через eth0, второй — через eth1, третий — через eth2, а четвертый снова через eth0 и т.д.

mode=1 (active-backup)
Когда используется этот метод, активен только один физический интерфейс, а остальные работают как резервные на случай отказа основного.

mode=2 (balance-xor)
В данном случае объединенный интерфейс определяет, через какую физическую сетевую карту отправить пакеты, в зависимости от MAC-адресов источника и получателя.

mode=3 (broadcast) Широковещательный режим, все пакеты отправляются через каждый интерфейс. Имеет ограниченное применение, но обеспечивает значительную отказоустойчивость.

mode=4 (802.3ad - Link Aggregation Control Protocol (LACP))
Особый динамический режим объединения. Для него требуется специально настраивать коммутатор, к которому подключен объединенный интерфейс. Реализует стандарты объединения каналов IEEE и обеспечивает как увеличение пропускной способности, так и отказоустойчивость.

mode=5 (balance-tlb)
Распределение нагрузки при передаче. Входящий трафик обрабатывается в обычном режиме, а при передаче интерфейс определяется на основе данных о загруженности.

mode=6 (balance-alb)
Адаптивное распределение нагрузки. Аналогично предыдущему режиму, но с возможностью балансировать также входящую нагрузку.

Настройка:

В семействе Debian:

Включаем поддержку ядром агрегирования

modprobe bonding

Создаем агрегированный интерфейс типа mode 0

ip link add bond0 type bond mode 802.3ad

Назначаем физические интерфесы на созданный ранее bond0

ip link set eth0 master bond0

ip link set eth1 master bond0

для сохранения же настройки после перезагрузки, необходимо отредактировать файл сетевых настроек (в ubuntu /etc/netplan), явно прописав создание и характериски bond0

Например, /etc/netplan/

auto bond0

iface bond0 inet static

    address 192.168.0.2

    netmask 255.255.255.0    

    gateway 192.168.0.1

    dns-nameservers 8.8.8.8

    dns-search domain.local

        slaves eth0 eth1

        bond_mode 0

        bond-miimon 100

        bond_downdelay 200

        bound_updelay 200

Для включения агрегированного интерфейса перезапускаем сетевую службу

systemctl restart networking.service

либо отключить физические интерфейсы и включить агрегированный

ifdown eth0 && ifdown eth1 && ifup bond0


5) Сколько IP адресов в сети с маской /29 ? Сколько /29 подсетей можно получить из сети с маской /24. Приведите несколько примеров /29 подсетей внутри сети 10.10.10.0/24.

Ответ:

Префикс /29 предоставляет нам 2*3 = 8 адресов. Из них под хосты мы можем использовать 6 адресов за вычетом адресов под адрес сети и броадкаст.

Из префикса /24 можно получить 256/8 = 32 подсети. 

Примеры:

10.10.10.0/24 делим:

10.10.10.0/29

10.10.10.8/29

10.10.10.16/29

10.10.10.32/29

...........

10.10.10.248/29
  

6) Задача: вас попросили организовать стык между 2-мя организациями. Диапазоны 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16 уже заняты. Из какой подсети допустимо взять частные IP адреса? Маску выберите из расчета максимум 40-50 хостов внутри подсети.

Ответ:

Согласно вопросу, все широко известные частные диапазоны сетей заняты.

есть еще частный диапазон, правда не для таких целей выделенный:
100.64.0.0/10, выделен IANA согласно RFC 6598 для межпровайдеровного взаимодействия, что не отменяет возможности его использования в данном случае. 
Для сети на 40-50 хостов нам минимум необходим префикс /26 (64 адреса, 62 можно использовать под хосты). Например, 100.64.0.0/26, 100.64.0.64/26, 100.64.0.128/26 и т.д.

7) Как проверить ARP таблицу в Linux, Windows? Как очистить ARP кеш полностью? Как из ARP таблицы удалить только один нужный IP?

Ответ:

В Windows

Просмотр arp-таблицы

arp -a

Очистка arp-таблицы полностью

arp -d *

Удаление конкретного ip

arp -d inet_addr

В Linux

можно использовать утилиту arp (в настоящее время доступна после установки пакета net-tools)

либо 

ip neighbor (ip n) - для просмотра записей

ip n del dev name_intf 192.168.0.1 - удаление одной записи

ip neigh flush dev name_intf - удаление всех записей на интерфейсе

ip neigh flush - удаление всех записей 



 


